<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>first class functions</title>
    </head>
    <body>
        <h1>Testing First Class Functions Here</h1>
        <p>All access pass for them functions. Pass em around y'all.</p>

        <script type="text/javascript">
            alert("hello");

            // create an array of passenger objects with name and paid boolean
            var passengers = [  {name: "Adam", paid: true, ticket: "firstclass"},
                                {name: "Dr. Evel", paid: true, ticket: "coach"}
                            ];

            //////////////////////////////////////////
            //         CAN PLANE TAKEOFF?           //
            //////////////////////////////////////////

            // function to accept passengers and a test function argument
            // iterates passing [i] to the test function
            function canPlaneTakeOff(passengers, testForProblem) {
                for (var i=0; i < passengers.length; i++ ){
                    console.log('processing ' + passengers[i].name);
                    if ( testForProblem(passengers[i]) ) {
                        return false; // problem found
                    }
                }
                return true; // no problems found
            }

            // test function onNoFlyList?
            function someoneOnNoFlyList(passenger) {
                // returns t if fail
                console.log('checking ' + passenger.name + ' against no fly list.');
                return (passenger.name === "Dr. Evel");
            }

            // test function checkNotPaid? returning T is fail
            function checkNotPaid(passenger){
                console.log("checking if " + passenger.name + " has paid...");
                return (!passenger.paid); // returns opposite of paid boolean
            }

            // call canPlaneTakeOff testing no fly
            var allCanFly = canPlaneTakeOff(passengers, someoneOnNoFlyList);
            if (!allCanFly) {
                alert("Do NOT takeoff. Found passenger on no fly list.");
            } else {
                alert("Passengers are all approved to fly.");
            }

            // call canPlaneTakeOff testing paid
            var allPaid = canPlaneTakeOff(passengers, checkNotPaid);
            if (!allPaid) { // if allPaid is false
                alert("Do NOT takeoff. Not all passengers have paid.");
            } else {
                alert("All passengers have paid.");
            }

            alert("Fasten your seat belts. Prepare for takeoff... taking off... approaching cruising altitude... the captain has turned off the fasten your seat belt sign.")


            //////////////////////////////////////////
            //            SERVE PASSENGERS          //
            //////////////////////////////////////////

            // servePassengers iterates them calling serveCustomer
            function serveThePassengers(passengers) {
                for (var i = 0; i < passengers.length; i++ ) {
                    serveCustomer(passengers[i]);
                }
            }

            // serveCustomer uses CreateDrinkOrderFunction to return getDrinkOrderFunction for that customer based on their ticket
            function serveCustomer(passenger) {
                alert("now serving " + passenger.name + ".");
                var getDrinkOrderFunction = CreateDrinkOrderFunction(passenger);
                getDrinkOrderFunction(); // alert custom take order phrase
            }

            // CreateDrinkOrderFunction customizes mssg based on ticket
            function CreateDrinkOrderFunction(passenger) {
                var orderFunction;
                if (passenger.ticket === "firstclass") {
                    orderFunction = function() {
                        alert("Good evening " + passenger.name + " will it be wine, beer or perrier for you today?");
                    }
                } else {
                    orderFunction = function() {
                        alert("want some pop " + passenger.name + "?");
                    }
                }
                return orderFunction;
            }

            // call serveThePassengers to initiate serve code
            serveThePassengers(passengers); 






        </script>

    </body>
</html>
